<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.docmall.mapper.ReviewMapper">


	<insert id="create" parameterType="com.docmall.domain.ReviewVO">
		INSERT INTO REVIEW_TBL(
		  REVIEW_NO, 
		  MBR_ID,
		  GDS_CODE,
		  REVIEW_SCORE,
		  REVIEW_CN
		)VALUES(
		  SEQ_REVIEW_NUM.NEXTVAL,
		  #{mbr_id},
		  #{gds_code},
		  #{review_score},
		  #{review_cn}
		)
	</insert>

	<select id="reviewList" resultType="com.docmall.domain.ReviewVO">
	
		<![CDATA[
		SELECT RN, 
			   REVIEW_NO, 
			   MBR_ID,
			   GDS_CODE,
		 	   REVIEW_SCORE,
		       REVIEW_CN,
		       REVIEW_REG_DATE,
		       REVIEW_UPDATE_DATE
		FROM (
		      SELECT  /*+ INDEX_DESC(REVIEW_TBL PK_REVIEW_NO)*/ ROWNUM RN, 
		             REVIEW_NO, 
				     MBR_ID,
				     GDS_CODE,
			 	     REVIEW_SCORE,
			         REVIEW_CN,
			         REVIEW_REG_DATE,
			         REVIEW_UPDATE_DATE
		      FROM REVIEW_TBL
		      WHERE  GDS_CODE = #{gds_code}  AND                                   
			  ROWNUM <= #{cri.pageNum} * #{cri.amount}
			  )
			  	WHERE 
			  	RN > ((#{cri.pageNum}-1) * #{cri.amount})
		]]>
	
	</select>
	
	<select id="listCount" resultType="int">
		SELECT COUNT(*)  
		FROM REVIEW_TBL
		 WHERE  GDS_CODE = #{gds_code} 
	</select>
















</mapper>